#!/bin/bash

sauvegarde_dir="OLD"

# Vérification de l'existence du répertoire OLD
if [ ! -d "$sauvegarde_dir" ]
then
    mkdir "$sauvegarde_dir"

    # Vérification de la création du répertoire OLD
    if [ $? -eq 0 ]
    then
        echo "Le répertoire $sauvegarde_dir a été créé avec succès !"
    else
        echo "Erreur lors de la création du répertoire de sauvegarde $sauvegarde_dir"
        exit 1
    fi
fi

# Obtention de la date courante
date=$(date +%Y-%m-%d)

# Parcours des fichiers du répertoire courant
for fichier in *
do
    # Vérification que le fichier est un fichier ordinaire
    if [ -f "$fichier" ]
    then
        # Création d'un noveau nom de fichier avec la date courante
        nom="${fichier%.*}"
        extension="${fichier##*.}"
        nouveau_nom="$sauvegarde_dir"/"$nom#$date.$extension"

        # Copie du fichier dans le répertoire de sauvegarde
        cp "$fichier" "$nouveau_nom"

        if [ $? -eq 0 ]
        then
            echo "Le fichier '$fichier' a été copié avec succès dans le répertoire $sauvegarde_dir"
        else
            echo "Erreur lors de la copie du fichier '$fichier' dans le répertoire $sauvegarde_dir"
        fi
    fi
done

echo "Sauvegarde terminée !"